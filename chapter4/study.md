# 테스트

## 테스트 과정
1. 테스트에 필요한 데이터와 객체를 뜻하는 픽스처를 설정.
2. 이 픽스처들의 속성들을 검증 (주어진 초깃값에 기초하여 속성을 정확히 게산했는지)
3. 일시적으로 오류를 주입

### 테스트 추가하기
- 완벽하게 만드느라 테스트를 수행하지 못하느니, 불안전한 테스트라도 작성해 실행하는 것이 낫다.

### 테스트 코드에서 픽스처를 공유할 수 있게 하는 바업ㅂ?

```
const asia= new Province(sampleProvinceData()); // 이렇게 하면 안된다.

it ('shoftfall',()=>{})...
```

- 이렇게 하면 일시적인 효과는 있겠지만, 테스트 관련 버그 중 가장 지저분한 유형인 '테스트끼리 상호작용하게 하는 공유 픽스처'를 생성하는 원인이 된다. 자바스크립트에서 const 키워드는 asia 객체의 내용이 아니라 asia 를 가르키는 참조가 상수임을 뜻한다. 
- 따라서 나중에 다른 테스트에서 이 공유 객체의 값을 수정하면, 이 픽스처를 사용하는 또 다른 테스트가 실패할 수 있다.
- 즉, 테스트를 실행하는 순서에 따라 결과가 달라질 수 있다.

```
describe('province', ()=>{
    let asia;
    beforeEach(()=>{
        asia= new Province(sampleProvinceData());
    })
})
```

- beforeEach 구문은 각각의 테스트를 바로 전에 실행되어 asia 를 초기화하기 때문에, 모든 테스트가 자신만의 새로운 asia 를 사용하게 된다.
- 이처럼 개별 테스트를 실행할 때마다 픽스처를 새로 만들면 모든 테스트를 독립적으로 구성할 수 있어서, 결과를 예측할 수 없어 골치를 썩는 사태를 예방할 수 있다.
- 코드를 읽는 이들은 해당 describe 블록 안의 모든 테스트가 똑같은 기준 데이터로부터 시작한다는 사실을 쉽게 알 수 있다.


### 흔한 테스트 패턴
- beforeEach 블록에서 설정한 표준 픽스처를 취해서
- 테스트를 수행하고
- 이 픽스처가 일을 기대한 대로 처리했는지를 검증
- 설정-실행-검증 / 조건-발생-결과 / 준비-수행-단언

### 경계 조건 검사하기
- 컬렉션이 비었을 때 어떤 일이 일어나는지 (예시에서 producers 와 같은 경우)
- 숫자형이라면 0일 때를 검사해보기
- 음수를 넣어보면 좋음
- 문제가 생길 가능성이 있는 경계 조건을 생각해보고, 그 부분을 집중적으로 테스트하기

### 끝나지 않은 여정
- 버그 리포트를 받으면 가장 먼저 그 버그를 드러내는 단위 테스트부터 작성하자.

